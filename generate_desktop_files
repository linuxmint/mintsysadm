#!/usr/bin/python3

DOMAIN = "mintsysadm"
PATH = "/usr/share/locale"

import os
import gettext
import sys
sys.path.append('/usr/lib/linuxmint/common')
from mintcommon import additionalfiles

os.environ['LANGUAGE'] = "en_US.UTF-8"
gettext.install(DOMAIN, PATH)

prefix = "[Desktop Entry]\n"

suffix = """Exec=pkexec mintsysadm
Icon=mintsysadm
Terminal=false
X-MultipleArgs=false
Type=Application
Categories=GNOME;GTK;System;Settings;X-GNOME-SystemSettings;X-GNOME-Settings-Panel;XFCE;X-XFCE-SettingsDialog;X-XFCE-SystemSettings;
X-GNOME-Settings-Panel=system-administration
"""
additionalfiles.generate(DOMAIN, PATH, "usr/share/applications/mintsysadm.desktop", prefix, _("System Administration"), _("Configure the system"), suffix, keywords=_("system;administration;boot;grub")) # type: ignore

suffix = """Exec=mintsysadm-settings-user
Icon=preferences-desktop-user
Terminal=false
Type=Application
Categories=Settings;
NotShowIn=GNOME;KDE;XFCE;MATE;
StartupWMClass=mintsysadm-settings-user
"""
additionalfiles.generate(DOMAIN, PATH, "usr/share/applications/mintsysadm-settings-user.desktop", prefix, _("Account details"), _("User account and password"), suffix, keywords=_("user;account;password;avatar")) # type: ignore

suffix = """Exec=pkexec mintsysadm --users
Icon=system-users
Terminal=false
X-MultipleArgs=false
Type=Application
Categories=GNOME;GTK;System;Settings;X-GNOME-SystemSettings;X-GNOME-Settings-Panel;XFCE;X-XFCE-SettingsDialog;X-XFCE-SystemSettings;
X-GNOME-Settings-Panel=system-administration
NotShowIn=GNOME;KDE;XFCE;MATE;
"""
additionalfiles.generate(DOMAIN, PATH, "usr/share/applications/mintsysadm-users.desktop", prefix, _("Users"), _("Add or remove users"), suffix, keywords=_("users;accounts")) # type: ignore

prefix = """<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE policyconfig PUBLIC
 "-//freedesktop//DTD PolicyKit Policy Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/PolicyKit/1/policyconfig.dtd">
<policyconfig>

  <vendor>Linux Mint</vendor>
  <vendor_url>https://linuxmint.com/</vendor_url>

  <action id="com.linuxmint.mintsysadm">
    <icon_name>mintsysadm</icon_name>
"""

suffix = """
    <defaults>
      <allow_any>auth_admin_keep</allow_any>
      <allow_inactive>auth_admin_keep</allow_inactive>
      <allow_active>auth_admin_keep</allow_active>
    </defaults>
    <annotate key="org.freedesktop.policykit.exec.path">/usr/bin/mintsysadm</annotate>
    <annotate key="org.freedesktop.policykit.exec.allow_gui">true</annotate>
  </action>

</policyconfig>
"""
additionalfiles.generate_polkit_policy(DOMAIN, PATH, "usr/share/polkit-1/actions/com.linuxmint.mintsysadm.policy", prefix, _("System Administration"), suffix) # type: ignore
